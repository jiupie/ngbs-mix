"use strict";(self.webpackChunkngbs_mix=self.webpackChunkngbs_mix||[]).push([[882],{7505:(n,e,t)=>{t.r(e),t.d(e,{assets:()=>c,contentTitle:()=>r,default:()=>p,frontMatter:()=>i,metadata:()=>s,toc:()=>l});var a=t(5893),o=t(1151);const i={},r="BeanFactory",s={id:"spring/spring beanfactory\u548cApplicationContxt",title:"spring beanfactory\u548cApplicationContxt",description:"- BeanFactory\u63a5\u53e3\u63d0\u4f9b\u4e86\u83b7\u53d6Bean\u7684\u65b9\u6cd5",source:"@site/docs/spring/02-spring beanfactory\u548cApplicationContxt.md",sourceDirName:"spring",slug:"/spring/spring beanfactory\u548cApplicationContxt",permalink:"/ngbs-mix/docs/spring/spring beanfactory\u548cApplicationContxt",draft:!1,unlisted:!1,editUrl:"https://github.com/jiupie/ngbs-mix/docs/spring/02-spring beanfactory\u548cApplicationContxt.md",tags:[],version:"current",sidebarPosition:2,frontMatter:{},sidebar:"springSide",previous:{title:"\u4e8b\u4ef6\u76d1\u542c\u673a\u5236",permalink:"/ngbs-mix/docs/spring/\u4e8b\u4ef6\u76d1\u542c\u673a\u5236"}},c={},l=[{value:"DefaultListableBeanFactory",id:"defaultlistablebeanfactory",level:2},{value:"<code>beanPostProcess</code>\u540e\u7f6e\u5904\u7406\u5668\u7684\u987a\u5e8f",id:"beanpostprocess\u540e\u7f6e\u5904\u7406\u5668\u7684\u987a\u5e8f",level:2},{value:"ApplicationContext\u5bf9\u6bd4BeanFactory\u7684\u533a\u522b",id:"applicationcontext\u5bf9\u6bd4beanfactory\u7684\u533a\u522b",level:2},{value:"ApplicationContext\u7684\u5404\u79cd\u5b9e\u73b0",id:"applicationcontext\u7684\u5404\u79cd\u5b9e\u73b0",level:2},{value:"<code>ClassPathXmlApplicationContext</code>\u3001<code>FileSystemXmlApplicationContext</code>",id:"classpathxmlapplicationcontextfilesystemxmlapplicationcontext",level:3},{value:"AnnotationConfigApplicationContext",id:"annotationconfigapplicationcontext",level:3},{value:"AnnotationConfigServletWebServerApplicationContext",id:"annotationconfigservletwebserverapplicationcontext",level:3},{value:"<code>GenericApplicationContext</code>",id:"genericapplicationcontext",level:3},{value:"BeanFactory\u7684\u540e\u7f6e\u5904\u7406\u5668",id:"beanfactory\u7684\u540e\u7f6e\u5904\u7406\u5668",level:2},{value:"Bean\u7684\u540e\u7f6e\u5904\u7406\u5668",id:"bean\u7684\u540e\u7f6e\u5904\u7406\u5668",level:2},{value:"\u5e38\u7528\u7684Bean\u540e\u7f6e\u5904\u7406\u5668",id:"\u5e38\u7528\u7684bean\u540e\u7f6e\u5904\u7406\u5668",level:2},{value:"AutowiredAnnotationBeanPostProcessor",id:"autowiredannotationbeanpostprocessor",level:3},{value:"<code>ConfigurationClassPostProcessor</code>",id:"configurationclasspostprocessor",level:2},{value:"@ComponentScan\u7684\u5904\u7406",id:"componentscan\u7684\u5904\u7406",level:3}];function d(n){const e={code:"code",h1:"h1",h2:"h2",h3:"h3",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.a)(),...n.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(e.p,{children:(0,a.jsx)(e.img,{src:"https://cdn.nlark.com/yuque/0/2023/jpeg/1741454/1699336972969-1d1ba913-3d31-4a09-832b-5a20487835e1.jpeg",alt:""})}),"\n",(0,a.jsx)(e.h1,{id:"beanfactory",children:"BeanFactory"}),"\n",(0,a.jsxs)(e.ul,{children:["\n",(0,a.jsx)(e.li,{children:"BeanFactory\u63a5\u53e3\u63d0\u4f9b\u4e86\u83b7\u53d6Bean\u7684\u65b9\u6cd5"}),"\n"]}),"\n",(0,a.jsx)(e.p,{children:(0,a.jsx)(e.img,{src:"https://cdn.nlark.com/yuque/0/2022/png/1741454/1662221217171-2f2c6a01-d691-4677-9beb-a6d0d8752647.png#averageHue=%233c4349&clientId=ud191b97c-66c0-4&errorMessage=unknown%20error&from=paste&height=655&id=uab63c49e&originHeight=1310&originWidth=1500&originalType=binary&ratio=1&rotation=0&showTitle=false&size=396389&status=error&style=none&taskId=u2ee18e4f-2cb5-47d6-99b5-3feb70d07ef&title=&width=750",alt:"image.png"})}),"\n",(0,a.jsxs)(e.ul,{children:["\n",(0,a.jsxs)(e.li,{children:["\u63a7\u5236\u53cd\u8f6c,\u57fa\u672c\u7684\u4f9d\u8d56\u6ce8\u5165,\u4ee5\u53cabean\u7684\u5404\u4e2a\u751f\u547d\u5468\u671f,\u90fd\u662f\u7531\u5b83\u7684\u5b9e\u73b0\u7c7b\u63d0\u4f9b,\u4e3b\u8981\u7531",(0,a.jsx)(e.code,{children:"DefaultListableBeanFactory"}),"\u5b9e\u73b0"]}),"\n"]}),"\n",(0,a.jsx)(e.p,{children:(0,a.jsx)(e.img,{src:"https://cdn.nlark.com/yuque/0/2022/png/1741454/1662261651150-b2faca18-0629-4181-b1a8-4369419e1a35.png#averageHue=%23f5f5f5&clientId=ud191b97c-66c0-4&errorMessage=unknown%20error&from=paste&height=506&id=u01444e4e&originHeight=1012&originWidth=2916&originalType=binary&ratio=1&rotation=0&showTitle=false&size=103979&status=error&style=none&taskId=ub5c4546f-d25c-4ea9-baf5-b228d638525&title=&width=1458",alt:"DefaultListableBeanFactory.png"})}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-java",children:'@SpringBootApplication\npublic class SpringDemo1 {\n    public static void main(String[] args) throws NoSuchFieldException, IllegalAccessException {\n        ConfigurableApplicationContext run = SpringApplication.run(SpringDemo1.class, args);\n        ConfigurableListableBeanFactory beanFactory = run.getBeanFactory();\n\n        //\u83b7\u53d6DefaultSingletonBeanRegistry\u7684\u5355\u4f8b\u5bf9\u8c61 map\u96c6\u5408 \uff0c\u4e09\u7ea7\u7f13\u5b58\u4e5f\u5728\u8be5\u7c7b\u4e2d\n        Class<DefaultSingletonBeanRegistry> defaultSingletonBeanRegistryClass = DefaultSingletonBeanRegistry.class;\n        Field singletonObjects = defaultSingletonBeanRegistryClass.getDeclaredField("singletonObjects");\n        singletonObjects.setAccessible(true);\n        Map<String, Object> singletonMap = (Map<String, Object>) singletonObjects.get(beanFactory);\n        singletonMap.forEach((k, v) -> {\n            System.out.println(k + "=" + v);\n        });\n\n    }\n}\n'})}),"\n",(0,a.jsx)(e.h2,{id:"defaultlistablebeanfactory",children:"DefaultListableBeanFactory"}),"\n",(0,a.jsxs)(e.p,{children:["\u5b83\u4f5c\u4e3aBeanFactory \u7684\u5b9e\u73b0\n",(0,a.jsx)(e.img,{src:"https://cdn.nlark.com/yuque/0/2022/png/1741454/1662261651150-b2faca18-0629-4181-b1a8-4369419e1a35.png#averageHue=%23f5f5f5&clientId=ud191b97c-66c0-4&errorMessage=unknown%20error&from=paste&height=506&id=kkRdV&originHeight=1012&originWidth=2916&originalType=binary&ratio=1&rotation=0&showTitle=false&size=103979&status=error&style=none&taskId=ub5c4546f-d25c-4ea9-baf5-b228d638525&title=&width=1458",alt:"DefaultListableBeanFactory.png"})]}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-java",children:'    public static void main(String[] args) {\n        //\u521b\u5efaBeanFactory\u7684\u5b9e\u73b0\n        DefaultListableBeanFactory beanFactory = new DefaultListableBeanFactory();\n\n        //\u5f80beanFactory\u4e2d\u6ce8\u518cMyConfig\u7684BeanDefinition\n        AbstractBeanDefinition myConfigBeanDefinition = BeanDefinitionBuilder.genericBeanDefinition(MyConfig.class).setScope("singleton").getBeanDefinition();\n        beanFactory.registerBeanDefinition("myconfig", myConfigBeanDefinition);\n\n        //\u6dfb\u52a0\u51e0\u4e2a\u6bd4\u8f83\u91cd\u8981\u7684 bean\u5b9a\u4e49  beanDefinition\n        //\u52a0\u5165\u4e86BeanFactory\u7684\u540e\u7f6e\u5904\u7406\u5668   ConfigurationClassPostProcessor \u7684beanDefinition \uff0c\u5b83\u4f1a\u626b\u63cf\u5e26\u6709@Config\u7684\u7c7b\uff0c\u5e76\u628a\u8be5\u7c7b\u7684@Bean \u548c @Import \u5bf9\u4e8e\u7684\u7c7b\u7684BeanDefinition\u52a0\u5165\u5230BeanFactory\u4e2d\uff0c\u5e76\u4e14\u6dfb\u52a0\u4e86BeanPostProcessor\u52a0\u5165\u4e86ImportAwareBeanPostProcessor\n        //\n        //\u52a0\u5165\u4e86BeanPostProcessor\u5904\u7406\u5668     AutowiredAnnotationBeanPostProcessor   CommonAnnotationBeanPostProcessor\u7684beanDefinition \u5e76\u6ca1\u6709\u5b9e\u4f8b\u5316\u624d\n        // \u5148\u6267\u884c BeanDefinitionRegistryPostProcessor.postProcessBeanDefinitionRegistry->  BeanFactoryPostProcessor.postProcessBeanFactory\n        AnnotationConfigUtils.registerAnnotationConfigProcessors(beanFactory);\n\n\n        System.out.println("==============beanFactoryPostProcess start==============================");\n        //BeanFactoryPostProcessor \u7684  \u5b9e\u4f8b\u5316\n        Map<String, BeanFactoryPostProcessor> beansOfType = beanFactory.getBeansOfType(BeanFactoryPostProcessor.class);\n        beansOfType.forEach((k, v) -> {\n            //\u5e76\u4e14\u8c03\u7528BeanFactoryPostProcessor\u7684postProcessBeanFactory\u540e\u7f6e\u5904\u7406\u5668\n            v.postProcessBeanFactory(beanFactory);\n            System.out.println(k + "=" + v);\n        });\n\n        System.out.println("==============beanDefinitionNames start==============================");\n        //\u904d\u5386 beanFactory\u4e2d\u7684beanDefinition,\u770b\u770b\u52a0\u5165\u4e86\u591a\u5c11\n        String[] beanDefinitionNames = beanFactory.getBeanDefinitionNames();\n        for (String beanDefinitionName : beanDefinitionNames) {\n            System.out.println(beanDefinitionName);\n        }\n\n\n        System.out.println("==============\u5f80BeanFactory\u4e2d\u52a0\u5165BeanPostProcessor  start==============================");\n        //beanFactory \u52a0\u5165  beanPostProcessor \u5904\u7406\u5668  AutowiredAnnotationBeanPostProcessor   CommonAnnotationBeanPostProcessor\n//        Map<String, BeanPostProcessor> beanPostProcessorMap = beanFactory.getBeansOfType(BeanPostProcessor.class);\n//        beanPostProcessorMap.forEach((name, beanPostProcessor) -> {\n//            beanFactory.addBeanPostProcessor(beanPostProcessor);\n//            System.out.println(name);\n//        });\n\n        //\u8fd9\u91cc\u53ef\u4ee5\u6839\u636e \u6dfb\u52a0\u7684\u987a\u5e8f \u51b3\u5b9a\u90a3\u4e2abeanPostProcess\u5148\u6267\u884c  \u4f8b\u5982\uff1a@AutoWried @Resource\u5199\u5728\u4e00\u8d77\u7684\u65f6\u5019\uff0c\u4f1a\u4f7f\u7528\u90a3\u4e2a\u3001\n        //@AutoWried \u9ed8\u8ba4\u662f \u6309\u7167\u7c7b\u578b\u6ce8\u5165\n        //@Resource \u6309\u7167\u540d\u79f0\u6ce8\u5165\n        //beanFactory.getDependencyComparator()\u63d0\u4f9b\u7684\u6bd4\u8f83\u5668 \uff0c\u662f\u6839\u636egetOrder \u4ece\u5c0f\u5230\u5927\u6267\u884c\n        Map<String, BeanPostProcessor> beanPostProcessorMap = beanFactory.getBeansOfType(BeanPostProcessor.class);\n        beanPostProcessorMap.values().stream().sorted(beanFactory.getDependencyComparator()).forEach(beanPostProcessor -> {\n            beanFactory.addBeanPostProcessor(beanPostProcessor);\n            System.out.println(beanPostProcessor.getClass());\n        });\n\n\n        //\u63d0\u524d\u5b9e\u4f8b\u5316\u5355\u4f8b\u5bf9\u8c61\uff0c\u800c\u4e0d\u662f\u7b49\u5230\u8c03\u7528\u7684\u65f6\u5019\u5728\u5b9e\u4f8b\u5316 \n        //preInstantiateSingletons\u91cc\u9762\u4f1a\u8c03\u7528 getBean()\n        beanFactory.preInstantiateSingletons();\n\n        System.out.println("===============getBean=============================");\n        MyBean1 bean = beanFactory.getBean(MyBean1.class);\n        System.out.println(bean);\n        System.out.println(bean.getMyBean2());\n\n\n    }\n'})}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-java",children:'@Configuration\npublic class MyConfig {\n    @Bean\n    public MyBean1 myBean1() {\n        return new MyBean1();\n    }\n\n    @Bean\n    public MyBean2 myBean2() {\n        MyBean2 myBean2 = new MyBean2();\n        myBean2.setAge("myBean2");\n        return myBean2;\n    }\n\n    @Bean(name = "resourceMyBean2")\n    public MyBean2 resourceMyBean2() {\n        MyBean2 myBean2 = new MyBean2();\n        myBean2.setAge("resourceMyBean2");\n        return myBean2;\n    }\n}\n\n'})}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-java",children:'public class MyBean1 {\n    private String name;\n\n    @Autowired\n    @Resource(name = "resourceMyBean2")\n    private MyBean2 myBean2;\n\n    public MyBean1() {\n        System.out.println("mybean1\u6784\u9020\u3002\u3002\u3002");\n    }\n\n    public String getName() {\n        return name;\n    }\n\n    public void setName(String name) {\n        this.name = name;\n    }\n\n    public MyBean2 getMyBean2() {\n        return myBean2;\n    }\n\n    @Override\n    public String toString() {\n        return "MyBean1{" +\n                "name=\'" + name + \'\\\'\' +\n                ", myBean2=" + myBean2 +\n                \'}\';\n    }\n}\n'})}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-java",children:"public class MyBean2 {\n    private String age;\n\n    public String getAge() {\n        return age;\n    }\n\n    public void setAge(String age) {\n        this.age = age;\n    }\n\n    public MyBean2() {\n        System.out.println(\"mybean2\u6784\u9020\u3002\u3002\u3002\");\n    }\n\n    @Override\n    public String toString() {\n        return \"MyBean2{\" +\n                \"age='\" + age + '\\'' +\n                '}';\n    }\n}\n"})}),"\n",(0,a.jsx)(e.p,{children:"\u4ece\u4e0a\u9762\u4f7f\u7528BeanFacotry\u7684\u5b9e\u73b0DefaultListableBeanFactory,\u8fdb\u884cbeanDefinition\u6ce8\u5165 \u548c getbean\u53ef\u4ee5\u770b\u5230,beanFactory\u7684\u7279\u70b9\u5982\u4e0b:"}),"\n",(0,a.jsxs)(e.ul,{children:["\n",(0,a.jsx)(e.li,{children:(0,a.jsx)(e.strong,{children:"\u5e76\u4e0d\u4f1a\u4e3b\u52a8\u7684\u6dfb\u52a0\u548c\u8c03\u7528BeanFactoryPostProcessor\u540e\u7f6e\u5904\u7406\u5668\u7684"})}),"\n",(0,a.jsx)(e.li,{children:"\u4e0d\u4f1a\u4e3b\u52a8\u6dfb\u52a0BeanPostProcess"}),"\n",(0,a.jsx)(e.li,{children:"\u4e0d\u4f1a\u4e3b\u52a8\u5b9e\u4f8b\u5316\u5355\u4f8b\u5bf9\u8c61"}),"\n",(0,a.jsxs)(e.li,{children:["\u4e0d\u4f1a\u89e3\u6790 $","   #"]}),"\n"]}),"\n",(0,a.jsx)(e.p,{children:"\u6240\u4ee5\u53ef\u4ee5\u770b\u5230BeanFactory\u53ea\u662f\u4e00\u4e2a\u57fa\u7840\u7684\u5bb9\u5668,\u5f88\u591a\u7684\u6269\u5c55\u529f\u80fd\u90fd\u6ca1\u6709\u52a0\u8fdb\u6765,\u800cApplicationContext\u53ef\u4ee5\u7ed9\u6211\u4eec\u505a\u597d\u8fd9\u4e9b\u5de5\u4f5c,\u5982\u679c\u6211\u4eec\u7528\u6bd4\u8f83\u5e95\u5c42\u7684BeanFactory\u5c31\u9700\u8981\u6211\u4eec\u81ea\u5df1\u505a\u8fd9\u4e9b\u4e8b\u60c5"}),"\n",(0,a.jsx)(e.p,{children:"\u5173\u4e8e\u51e0\u4e2a\u7279\u6b8a\u7684beanFactory\u7684\u8bf4\u660e"}),"\n",(0,a.jsxs)(e.ul,{children:["\n",(0,a.jsxs)(e.li,{children:[(0,a.jsx)(e.code,{children:"**ConfigurableListableBeanFactory**"}),"**\uff1a\u80fd\u591f\u83b7\u53d6bean\u7684BeanDefinition     **",(0,a.jsx)(e.code,{children:"**BeanDefinition getBeanDefinition(String beanName)**"})]}),"\n",(0,a.jsxs)(e.li,{children:[(0,a.jsx)(e.code,{children:"**DefaultListableBeanFactory**"}),"**:\u63d0\u4f9b\u6ce8\u518c\u5355\u4f8bbean\u65b9\u6cd5\t\t**",(0,a.jsx)(e.code,{children:"**registerSingleton**"})]}),"\n",(0,a.jsxs)(e.li,{children:[(0,a.jsx)(e.code,{children:"**DefaultSingletonBeanRegistry**"}),"**:\u4e09\u7ea7\u7f13\u5b58 **","\n",(0,a.jsxs)(e.ul,{children:["\n",(0,a.jsx)(e.li,{children:"**singletonObjects:\u4e00\u7ea7\u7f13\u5b58 **"}),"\n",(0,a.jsx)(e.li,{children:"**earlySingltonObjects:\u4e8c\u7ea7\u7f13\u5b58   **"}),"\n",(0,a.jsx)(e.li,{children:(0,a.jsx)(e.strong,{children:"singletonFactories:\u4e09\u7ea7\u7f13\u5b58"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(e.h1,{id:"beanfactorypostprocessor\u7684\u540e\u7f6e\u5904\u7406\u5668\u987a\u5e8f",children:"BeanFactoryPostProcessor\u7684\u540e\u7f6e\u5904\u7406\u5668\u987a\u5e8f"}),"\n",(0,a.jsxs)(e.p,{children:["\u4e0e",(0,a.jsx)(e.code,{children:"beanPostProcessor"}),"\u540e\u7f6e\u5904\u7406\u5668\u7684\u987a\u5e8f\u4e00\u6837"]}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-java",children:"beansOfType.values().stream().sorted(beanFactory.getDependencyComparator()).forEach(beanFactoryPostProcessor -> {\n    beanFactoryPostProcessor.postProcessBeanFactory(beanFactory);\n});\n"})}),"\n",(0,a.jsxs)(e.h2,{id:"beanpostprocess\u540e\u7f6e\u5904\u7406\u5668\u7684\u987a\u5e8f",children:[(0,a.jsx)(e.code,{children:"beanPostProcess"}),"\u540e\u7f6e\u5904\u7406\u5668\u7684\u987a\u5e8f"]}),"\n",(0,a.jsxs)(e.p,{children:["\u5173\u4e8e\u6267\u884c\u987a\u5e8f ",(0,a.jsx)(e.code,{children:"beanPostProcess"}),"\u5904\u7406\u5668\u7684\u6267\u884c\u987a\u5e8f,\n\u4f8b\u5982\uff1a@AutoWried @Resource\u5199\u5728\u4e00\u8d77\u7684\u65f6\u5019\uff0c\u5230\u5e95\u4f1a\u4f7f\u7528\u90a3\u4e2a\u6ce8\u89e3,\u5982\u679c\u6211\u4eec\u81ea\u5df1\u4f7f\u7528BeanFactory,\u90a3\u8fd9\u4e2a\u65f6\u5019\u5c31\u662f\u6839\u636e",(0,a.jsx)(e.code,{children:"beanFactory.addBeanPostProcessor(\u540e\u7f6e\u5904\u7406\u5668)"}),"\u65b9\u6cd5\u8c03\u7528\u4e2d\u5148\u6dfb\u52a0\u90a3\u4e2a",(0,a.jsx)(e.code,{children:"beanPostProcess"}),"\u7684\u5904\u7406\u5668.\nBeanFactory\u4e2d\u4e5f\u63d0\u4f9b\u4e86\u6392\u5e8f\u6bd4\u8f83\u5668\u7684\u5b9e\u73b0(",(0,a.jsx)(e.code,{children:"beanFactory.getDependencyComparator()"}),"),\u6839\u636e",(0,a.jsx)(e.code,{children:"getOrder"}),"\u65b9\u6cd5\u83b7\u53d6\u51fa\u6765\u7684\u503c,\u8fdb\u884c\u6392\u5e8f"]}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-java",children:"Map<String, BeanPostProcessor> beanPostProcessorMap = beanFactory.getBeansOfType(BeanPostProcessor.class);\nbeanPostProcessorMap.values().stream().sorted(beanFactory.getDependencyComparator()).forEach(beanPostProcessor -> {\n    beanFactory.addBeanPostProcessor(beanPostProcessor);\n    System.out.println(beanPostProcessor.getClass());\n});\n"})}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-java",children:'//\u521b\u5efaBeanFactory\u7684\u5b9e\u73b0\nDefaultListableBeanFactory beanFactory = new DefaultListableBeanFactory();\n\n//\u5f80beanFactory\u4e2d\u6ce8\u518cMyConfig\u7684BeanDefinition\nAbstractBeanDefinition myConfigBeanDefinition = BeanDefinitionBuilder.genericBeanDefinition(MyConfig.class).setScope("singleton").getBeanDefinition();\nbeanFactory.registerBeanDefinition("myconfig", myConfigBeanDefinition);\n\n//\u6dfb\u52a0\u51e0\u4e2a\u6bd4\u8f83\u91cd\u8981\u7684 bean\u5b9a\u4e49  beanDefinition\n//\u52a0\u5165\u4e86BeanFactory\u7684\u540e\u7f6e\u5904\u7406\u5668   \n//\tConfigurationClassPostProcessor \u7684beanDefinition \uff0c\u5b83\u4f1a\u626b\u63cf\u5e26\u6709@Config\u7684\u7c7b\uff0c\u5e76\u628a\u8be5\u7c7b\u7684@Bean \u548c @Import \u5bf9\u4e8e\u7684\u7c7b\u7684BeanDefinition\u52a0\u5165\u5230BeanFactory\u4e2d\uff0c\u5e76\u4e14\u6dfb\u52a0\u4e86BeanPostProcessor\u52a0\u5165\u4e86ImportAwareBeanPostProcessor\n//\n//\u52a0\u5165\u4e86BeanPostProcessor\u5904\u7406\u5668    \n//\t\tAutowiredAnnotationBeanPostProcessor   CommonAnnotationBeanPostProcessor\u7684beanDefinition \u5e76\u6ca1\u6709\u5b9e\u4f8b\u5316\u624d\n// \u5148\u6267\u884c BeanDefinitionRegistryPostProcessor.postProcessBeanDefinitionRegistry->  BeanFactoryPostProcessor.postProcessBeanFactory\nAnnotationConfigUtils.registerAnnotationConfigProcessors(beanFactory);\n\n\nSystem.out.println("==============beanFactoryPostProcess start==============================");\n//BeanFactoryPostProcessor \u7684  \u5b9e\u4f8b\u5316\nMap<String, BeanFactoryPostProcessor> beansOfType = beanFactory.getBeansOfType(BeanFactoryPostProcessor.class);\nbeansOfType.forEach((k, v) -> {\n    //\u5e76\u4e14\u8c03\u7528BeanFactoryPostProcessor\u7684postProcessBeanFactory\u540e\u7f6e\u5904\u7406\u5668\n    v.postProcessBeanFactory(beanFactory);\n    System.out.println(k + "=" + v);\n});\n\n\nSystem.out.println("==============beanDefinitionNames start==============================");\n//\u904d\u5386 beanFactory\u4e2d\u7684beanDefinition,\u770b\u770b\u52a0\u5165\u4e86\u591a\u5c11\nString[] beanDefinitionNames = beanFactory.getBeanDefinitionNames();\nfor (String beanDefinitionName : beanDefinitionNames) {\n    System.out.println(beanDefinitionName);\n}\n\nSystem.out.println("==============\u5f80BeanFactory\u4e2d\u52a0\u5165BeanPostProcessor  start==============================");\n//\u8fd9\u91cc\u53ef\u4ee5\u6839\u636e \u6dfb\u52a0\u7684\u987a\u5e8f \u51b3\u5b9a\u90a3\u4e2abeanPostProcess\u5148\u6267\u884c  \u4f8b\u5982\uff1a@AutoWried @Resource\u5199\u5728\u4e00\u8d77\u7684\u65f6\u5019\uff0c\u4f1a\u4f7f\u7528\u90a3\u4e2a\u3001\n//@AutoWried \u9ed8\u8ba4\u662f \u6309\u7167\u7c7b\u578b\u6ce8\u5165\n//@Resource \u6309\u7167\u540d\u79f0\u6ce8\u5165\n//beanFactory.getDependencyComparator()\u63d0\u4f9b\u7684\u6bd4\u8f83\u5668 \uff0c\u662f\u6839\u636egetOrder \u4ece\u5c0f\u5230\u5927\u6267\u884c\nMap<String, BeanPostProcessor> beanPostProcessorMap = beanFactory.getBeansOfType(BeanPostProcessor.class);\nbeanPostProcessorMap.values().stream().sorted(beanFactory.getDependencyComparator()).forEach(beanPostProcessor -> {\n    beanFactory.addBeanPostProcessor(beanPostProcessor);\n    System.out.println(beanPostProcessor.getClass());\n});\n\n\n//\u63d0\u524d\u5b9e\u4f8b\u5316\u5355\u4f8b\u5bf9\u8c61\uff0c\u800c\u4e0d\u662f\u7b49\u5230\u8c03\u7528\u7684\u65f6\u5019\u5728\u5b9e\u4f8b\u5316 getBean\nbeanFactory.preInstantiateSingletons();\n\nSystem.out.println("===============getBean=============================");\nMyBean1 bean = beanFactory.getBean(MyBean1.class);\nSystem.out.println(bean);\nSystem.out.println(bean.getMyBean2());\n\n'})}),"\n",(0,a.jsx)(e.h1,{id:"applicationcontext",children:"ApplicationContext"}),"\n",(0,a.jsx)(e.h2,{id:"applicationcontext\u5bf9\u6bd4beanfactory\u7684\u533a\u522b",children:"ApplicationContext\u5bf9\u6bd4BeanFactory\u7684\u533a\u522b"}),"\n",(0,a.jsx)(e.p,{children:"ApplicationContext\u4e5f\u7ee7\u627f\u4e86BeanFactory,\u4f46\u662f\u6bd4BeanFactory\u591a\u7c7b\u56db\u4e2a\u63a5\u53e3"}),"\n",(0,a.jsxs)(e.ul,{children:["\n",(0,a.jsx)(e.li,{children:"MessageSource:\u56fd\u9645\u5316\u529f\u80fd"}),"\n"]}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-java",children:'ConfigurableApplicationContext run = SpringApplication.run(SpringDemo1.class, args);\n\n//\u56fd\u9645\u5316\nSystem.out.println(run.getMessage("hello", null, Locale.ENGLISH));\n'})}),"\n",(0,a.jsxs)(e.p,{children:["resources\u6587\u4ef6\u5939\u4e2d\u9700\u8981\u5efa\u7acbmessages bunld\n",(0,a.jsx)(e.img,{src:"https://cdn.nlark.com/yuque/0/2022/png/1741454/1662263730287-f245e1e0-1532-4040-881e-03b1e9e6bd2a.png#averageHue=%23f7f7f7&clientId=ud191b97c-66c0-4&errorMessage=unknown%20error&from=paste&height=166&id=uf6af6a94&originHeight=332&originWidth=706&originalType=binary&ratio=1&rotation=0&showTitle=false&size=41350&status=error&style=none&taskId=u1c806d3b-2665-4bcb-af40-314e136eada&title=&width=353",alt:"image.png"}),"\n",(0,a.jsx)(e.img,{src:"https://cdn.nlark.com/yuque/0/2022/png/1741454/1662263774348-885e7f06-25d7-4785-bfa3-fd9734cef162.png#averageHue=%23fbfaf6&clientId=ud191b97c-66c0-4&errorMessage=unknown%20error&from=paste&height=106&id=u641c1a94&originHeight=212&originWidth=1682&originalType=binary&ratio=1&rotation=0&showTitle=false&size=24486&status=error&style=none&taskId=u61d3579d-03d9-48f0-a123-491313bfd9c&title=&width=841",alt:"image.png"})]}),"\n",(0,a.jsxs)(e.ul,{children:["\n",(0,a.jsxs)(e.li,{children:[(0,a.jsx)(e.code,{children:"**ResourcePatternResolver**"}),":\u53ef\u4ee5\u6839\u636e\u8def\u5f84\u5339\u914d\u83b7\u53d6\u6587\u4ef6\u6d41"]}),"\n"]}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-java",children:'ConfigurableApplicationContext run = SpringApplication.run(SpringDemo1.class, args);\n\n//classpath*:  \u4f1a\u4ecejar\u4e2d\u641c\u7d22\n//classpath:   \u4e0d\u4f1a\u4ecejar\u5305\u4e2d\u641c\u7d22\nResource[] resources = run.getResources("classpath*:application.yml");\nfor (Resource resource : resources) {\n    System.out.println(resource);\n}\n'})}),"\n",(0,a.jsxs)(e.ul,{children:["\n",(0,a.jsxs)(e.li,{children:[(0,a.jsx)(e.code,{children:"**ApplicationEventPublisher**"}),":\u53d1\u5e03\u4e8b\u4ef6"]}),"\n"]}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-java",children:"ConfigurableApplicationContext run = SpringApplication.run(SpringDemo1.class, args);\n\n//\u4e8b\u4ef6\u53d1\u5e03\nrun.publishEvent(new MyEvent(run));\n"})}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-java",children:'public class MyEvent extends ApplicationEvent {\n    public MyEvent(Object source) {\n        super(source);\n    }\n}\n\n@Component\npublic class MyListener {\n    @EventListener\n    public void envent(MyEvent myEvent) {\n        System.out.println("\u4e8b\u4ef6\uff1a"+myEvent);\n    }\n}\n\n'})}),"\n",(0,a.jsxs)(e.ul,{children:["\n",(0,a.jsxs)(e.li,{children:[(0,a.jsx)(e.code,{children:"**EnvironmentCapable**"}),":\u83b7\u53d6environment\u73af\u5883\u7684\u503c"]}),"\n"]}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-java",children:'ConfigurableApplicationContext run = SpringApplication.run(SpringDemo1.class, args);\n\nConfigurableEnvironment environment = run.getEnvironment();\nSystem.out.println(environment.getProperty("java.class.path"));\n'})}),"\n",(0,a.jsx)(e.p,{children:(0,a.jsx)(e.img,{src:"https://cdn.nlark.com/yuque/0/2022/png/1741454/1662262221021-7e654f07-237c-43c1-bc5b-f81abd13b366.png#averageHue=%23f7f6f4&clientId=ud191b97c-66c0-4&errorMessage=unknown%20error&from=paste&height=331&id=u53e82202&originHeight=662&originWidth=2752&originalType=binary&ratio=1&rotation=0&showTitle=false&size=283102&status=error&style=none&taskId=u3a7c7ccc-80ca-40fd-a99d-1ad4fcf7c76&title=&width=1376",alt:"image.png"})}),"\n",(0,a.jsxs)(e.p,{children:[(0,a.jsx)(e.code,{children:"ApplicationContext"}),"\u7684\u4e3b\u8981\u5b9e\u73b0\u7c7b\u662f",(0,a.jsx)(e.code,{children:"AbstractApplicationContext"}),",\u5b9e\u73b0\u4e86",(0,a.jsx)(e.code,{children:"ConfigurableApplicationContext"}),"\u63a5\u53e3,\u91cc\u9762\u4e3b\u8981\u6709refresh\u65b9\u6cd5\n",(0,a.jsx)(e.img,{src:"https://cdn.nlark.com/yuque/0/2022/png/1741454/1662262725437-2c9156a5-47ad-4567-a386-8c8c94cc1f36.png#averageHue=%23f7f7f7&clientId=ud191b97c-66c0-4&errorMessage=unknown%20error&from=paste&height=329&id=uaf1dba8c&originHeight=658&originWidth=2754&originalType=binary&ratio=1&rotation=0&showTitle=false&size=86046&status=error&style=none&taskId=u5c54029e-cdec-4a52-be5f-c3f9b2a0c41&title=&width=1377",alt:"image.png"})]}),"\n",(0,a.jsx)(e.h2,{id:"applicationcontext\u7684\u5404\u79cd\u5b9e\u73b0",children:"ApplicationContext\u7684\u5404\u79cd\u5b9e\u73b0"}),"\n",(0,a.jsxs)(e.p,{children:[(0,a.jsx)(e.img,{src:"https://cdn.nlark.com/yuque/0/2022/png/1741454/1662518153814-92888f6b-d986-46c2-afb9-78b5fd3e3601.png#averageHue=%23f9f8f8&clientId=u1e2e0e45-e01d-4&errorMessage=unknown%20error&from=paste&height=596&id=uaf2423b6&originHeight=596&originWidth=1875&originalType=binary&ratio=1&rotation=0&showTitle=false&size=54566&status=error&style=none&taskId=u6916bdfd-ce45-4ca8-9858-9bc8cca6a14&title=&width=1875",alt:"image.png"}),"\nApplicationContext\u4e3b\u8981\u6709",(0,a.jsx)(e.code,{children:"ClassPathXmlApplicationContext"}),"\u3001",(0,a.jsx)(e.code,{children:"FileSystemXmlApplicationContext"}),"\u3001",(0,a.jsx)(e.code,{children:"AnnotationConfigServletWebServerApplicationContext"}),"\u3001",(0,a.jsx)(e.code,{children:"AnnotationConfigApplicationContext"}),"\u3001",(0,a.jsx)(e.code,{children:"GenericApplicationContext"})]}),"\n",(0,a.jsxs)(e.h3,{id:"classpathxmlapplicationcontextfilesystemxmlapplicationcontext",children:[(0,a.jsx)(e.code,{children:"ClassPathXmlApplicationContext"}),"\u3001",(0,a.jsx)(e.code,{children:"FileSystemXmlApplicationContext"})]}),"\n",(0,a.jsxs)(e.p,{children:[(0,a.jsx)(e.code,{children:"ClassPathXmlApplicationContext"}),"\u3001",(0,a.jsx)(e.code,{children:"FileSystemXmlApplicationContext"}),"\u90fd\u662f\u901a\u8fc7\u52a0\u8f7dxml\u914d\u7f6e\u6587\u4ef6\u8fdb\u884c\u52a0\u8f7d"]}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-xml",children:'<?xml version="1.0" encoding="UTF-8" ?>\n<beans xmlns="http://www.springframework.org/schema/beans"\n  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n  xsi:schemaLocation="http://www.springframework.org/schema/beans\n  https://www.springframework.org/schema/beans/spring-beans.xsd">\n\n  <bean id="myBean1" class="com.wl.spring.config.MyBean1">\n    <property name="myBean2" ref="myBean2"/>\n  </bean>\n  <bean id="myBean2" class="com.wl.spring.config.MyBean2">\n\n  </bean>\n</beans>\n'})}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-java",children:'    public static void testClassPathXmlApplication() {\n        ClassPathXmlApplicationContext classPathXmlApplicationContext = new ClassPathXmlApplicationContext("b01.xml");\n        String[] beanDefinitionNames = classPathXmlApplicationContext.getBeanDefinitionNames();\n\n        //\u6253\u5370beanDefinition\n        for (String beanDefinitionName : beanDefinitionNames) {\n            System.out.println(beanDefinitionName);\n        }\n\n        MyBean1 myBean1 = classPathXmlApplicationContext.getBean(MyBean1.class);\n        System.out.println(myBean1);\n    }\n'})}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-java",children:'//\u57fa\u4e8e\u78c1\u76d8\u8def\u5f84\u7684\n    public static void testFileSystemXmlApplicationContext() {\n        FileSystemXmlApplicationContext fileSystemXmlApplicationContext = new FileSystemXmlApplicationContext("src/main/resources/b01.xml");\n        String[] beanDefinitionNames = fileSystemXmlApplicationContext.getBeanDefinitionNames();\n\n        //\u6253\u5370beanDefinition\n        for (String beanDefinitionName : beanDefinitionNames) {\n            System.out.println(beanDefinitionName);\n        }\n\n        MyBean1 myBean1 = fileSystemXmlApplicationContext.getBean(MyBean1.class);\n        System.out.println(myBean1);\n    }\n'})}),"\n",(0,a.jsxs)(e.p,{children:["\u4ed6\u4eec\u7684\u5b9e\u73b0\u90fd\u662f\u901a\u8fc7",(0,a.jsx)(e.code,{children:"XmlBeanDefinitionReader"}),"\u5bf9xml\u6587\u4ef6\u8fdb\u884c\u8bfb\u53d6\uff0c\u7136\u540e\u8c03\u7528",(0,a.jsx)(e.code,{children:"xmlBeanDefinitionReader.loadBeanDefinitions"}),"\u52a0\u8f7d",(0,a.jsx)(e.code,{children:"BeanDefinition"})]}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-java",children:'   public static void testMyXml() {\n        DefaultListableBeanFactory beanFactory = new DefaultListableBeanFactory();\n        String[] beanDefinitionNames = beanFactory.getBeanDefinitionNames();\n        for (String beanDefinitionName : beanDefinitionNames) {\n            System.out.println(beanDefinitionName);\n        }\n\n        XmlBeanDefinitionReader xmlBeanDefinitionReader = new XmlBeanDefinitionReader(beanFactory);\n        //ClassPathXmlApplicationContext\n//        xmlBeanDefinitionReader.loadBeanDefinitions(new ClassPathResource("b01.xml"));\n\n//        FileSystemXmlApplicationContext\n        xmlBeanDefinitionReader.loadBeanDefinitions(new FileSystemResource("/Users/dile/code/javacode/spring-test-pro/src/main/resources/b01.xml"));\n\n        String[] beanDefinitionNames1 = beanFactory.getBeanDefinitionNames();\n        for (String beanDefinitionName : beanDefinitionNames1) {\n            System.out.println(beanDefinitionName);\n        }\n    }\n'})}),"\n",(0,a.jsx)(e.h3,{id:"annotationconfigapplicationcontext",children:"AnnotationConfigApplicationContext"}),"\n",(0,a.jsxs)(e.p,{children:[(0,a.jsx)(e.code,{children:"AnnotationConfigApplicationContext"}),"\u4f7f\u7528\u914d\u7f6e\u7c7b\u7684\u65b9\u5f0f\u6765\u8fdb\u884c\u52a0\u8f7d\uff0c\u4e3b\u8981\u901a\u8fc7@Configuration\u8fdb\u884c"]}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-java",children:"    public static void testAnnotationConfig() {\n        AnnotationConfigApplicationContext annotationConfigApplicationContext = new AnnotationConfigApplicationContext(MyConfig.class);\n        MyBean1 myBean1 = annotationConfigApplicationContext.getBean(MyBean1.class);\n        System.out.println(myBean1);\n    }\n\n"})}),"\n",(0,a.jsxs)(e.p,{children:[(0,a.jsx)(e.code,{children:"AnnotationConfigApplicationContext"}),"\u5185\u90e8\u6709",(0,a.jsx)(e.code,{children:"AnnotatedBeanDefinitionReader"}),"\u548c",(0,a.jsx)(e.code,{children:"ClassPathBeanDefinitionScanner"}),"\n",(0,a.jsx)(e.code,{children:"AnnotatedBeanDefinitionReader"}),"\u5728",(0,a.jsx)(e.code,{children:"AnnotationConfigApplicationContext"}),"\u5185\u90e8 \u4e3b\u8981\u7528\u4e8e\u5904\u7406 ",(0,a.jsx)(e.code,{children:"new AnnotationConfigApplicationContext(MyConfig.class);"}),"\u5e26\u7c7bclass\u7684\u60c5\u51b5"]}),"\n",(0,a.jsxs)(e.ul,{children:["\n",(0,a.jsxs)(e.li,{children:["\u4f5c\u7528\uff1a\u5b83\u6709",(0,a.jsx)(e.code,{children:"registerBean"}),"\u53ef\u4ee5\u5c06\u751f\u6210\u8be5\u7c7b\u7684beandefinition\uff0c\u7136\u540e\u653e\u5165\u5bb9\u5668\u4e2d"]}),"\n",(0,a.jsxs)(e.li,{children:["\u751f\u6210\u7684beandefinition\u7c7b\u578b\u662f",(0,a.jsx)(e.code,{children:"AnnotatedBeanDefinition"}),",\u5728\u7ecf\u8fc7",(0,a.jsx)(e.code,{children:"ConfigurationClassPostProcessor"}),"\u5904\u7406\u7684\u65f6\u5019\uff0c\u4e0d\u7ba1\u8be5bean\u7c7b\u4e0a\u6709\u6ca1\u6709",(0,a.jsx)(e.code,{children:"@Configuration"}),"\u6ce8\u89e3\uff0c\u90fd\u4f1a\u88ab\u540c\u7b49\u5904\u7406\uff0c\u4e5f\u5c31\u662f\u4f1a\u5904\u7406\u8be5bean\u7c7b\u4e2d\u7684\u6ce8\u5165bean\u7684\u6ce8\u5165\uff0c\u4f8b\u5982",(0,a.jsx)(e.code,{children:"@Import"})," ",(0,a.jsx)(e.code,{children:"@ImportResource"})," ",(0,a.jsx)(e.code,{children:"@ComponentScan"}),"  ",(0,a.jsx)(e.code,{children:"@Bean"}),"\u7b49\u6ce8\u89e3"]}),"\n"]}),"\n",(0,a.jsxs)(e.p,{children:[(0,a.jsx)(e.code,{children:"ClassPathBeanDefinitionScanner"}),"\u5728",(0,a.jsx)(e.code,{children:"AnnotationConfigApplicationContext"}),"\u5185\u90e8 \u4e3b\u8981\u7528\u4e8e\u5904\u7406 ",(0,a.jsx)(e.code,{children:'new AnnotationConfigApplicationContext("com.wl.mybean");'}),"\u5e26\u5305\u540d\u7684\u60c5\u51b5"]}),"\n",(0,a.jsx)(e.h3,{id:"annotationconfigservletwebserverapplicationcontext",children:"AnnotationConfigServletWebServerApplicationContext"}),"\n",(0,a.jsx)(e.p,{children:"AnnotationConfigServletWebServerApplicationContext\u4e3b\u8981\u662f\u53ef\u4ee5\u52a0\u5165Servlet"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-java",children:"    public static void testServletContext() {\n        AnnotationConfigServletWebServerApplicationContext servletWebServerApplicationContext = new AnnotationConfigServletWebServerApplicationContext(WebConfig.class);\n    }\n"})}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-java",children:'    @Configuration\n    static class WebConfig {\n        @Bean\n        public ServletWebServerFactory servletWebServerFactory() {\n            return new TomcatServletWebServerFactory();\n        }\n\n        @Bean\n        public DispatcherServlet dispatcherServlet() {\n            return new DispatcherServlet();\n        }\n\n        @Bean\n        public DispatcherServletRegistrationBean dispatcherServletRegistrationBean(DispatcherServlet dispatcherServlet) {\n            return new DispatcherServletRegistrationBean(dispatcherServlet, "/");\n        }\n\n        @Bean("/hello")\n        public Controller controller1() {\n            return new Controller() {\n                @Override\n                public ModelAndView handleRequest(HttpServletRequest request, HttpServletResponse response) throws Exception {\n                    response.getWriter().print("hello");\n                    return null;\n                }\n            };\n        }\n    }\n}\n'})}),"\n",(0,a.jsx)(e.h3,{id:"genericapplicationcontext",children:(0,a.jsx)(e.code,{children:"GenericApplicationContext"})}),"\n",(0,a.jsx)(e.p,{children:"**GenericApplicationContext\u4e0d\u4f1a\u50cf\u5176\u4ed6\u7684ApplicationContext\u4e00\u6837\uff0c\u7ed9\u6211\u4eec\u52a0\u5165\u5404\u79cd\u5404\u6837\u7684BeanFactoryPostProcess\u3001BeanPostProcess\u7b49\uff0c\u9700\u8981\u81ea\u5df1\u624b\u52a8\u6dfb\u52a0\uff0c\u4f46\u662f\u5982\u679c\u6211\u4eec\u52a0\u5165\u4e86\u8fd9\u4e9b\u5904\u7406\u5668\u53ef\u4ee5\u7ed9\u6211\u4eec\u6267\u884c\uff0c**\u4e0d\u9700\u8981\u50cf\u4f7f\u7528DeafultListableBeanFactory\u8981\u6211\u4eec\u624b\u52a8\u6dfb\u52a0\uff0c\u8fd8\u9700\u8981\u624b\u52a8\u6267\u884c\u3002"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-java",children:'    public static void main(String[] args) {\n        GenericApplicationContext genericApplicationContext = new GenericApplicationContext();\n\n\n        //\u6ce8\u518c\u4e09\u4e2abean\n        genericApplicationContext.registerBean("bean1", Bean1.class);\n        genericApplicationContext.registerBean("bean2", Bean2.class);\n        genericApplicationContext.registerBean("bean3", Bean3.class);\n        genericApplicationContext.registerBean("bean4", Bean4.class);\n\n        //@Autowired @Value\n        genericApplicationContext.registerBean(AutowiredAnnotationBeanPostProcessor.class);\n        //\u52a0\u5165 ${}\u89e3\u6790\n        genericApplicationContext.getDefaultListableBeanFactory().setAutowireCandidateResolver(new ContextAnnotationAutowireCandidateResolver());\n\n        //\u5904\u7406 @Resource @PostConstruct @PreDestroy\n        genericApplicationContext.registerBean(CommonAnnotationBeanPostProcessor.class);\n\n        //\u5904\u7406@ConfigurationProperties\n        ConfigurationPropertiesBindingPostProcessor.register(genericApplicationContext.getDefaultListableBeanFactory());\n\n        //\u5237\u65b0\u5bb9\u5668\uff0c\u4f1a\u6267\u884c beanFactoryPostProcessor   beanPostProcessor,\u53ea\u662f\u4e0d\u4f1a\u81ea\u52a8\u6dfb\u52a0 \u5404\u79cd\u5904\u7406\u5668\n        genericApplicationContext.refresh();\n\n        Bean4 bean4 = genericApplicationContext.getBean(Bean4.class);\n        System.out.println(bean4);\n\n        genericApplicationContext.close();\n\n\n    }\n'})}),"\n",(0,a.jsx)(e.h2,{id:"beanfactory\u7684\u540e\u7f6e\u5904\u7406\u5668",children:"BeanFactory\u7684\u540e\u7f6e\u5904\u7406\u5668"}),"\n",(0,a.jsxs)(e.p,{children:[(0,a.jsx)(e.img,{src:"https://cdn.nlark.com/yuque/0/2022/png/1741454/1662511389944-69eaf4d3-bc16-4ba3-9f45-dc1d3c9b219c.png#averageHue=%23f3f2f1&clientId=u1e2e0e45-e01d-4&errorMessage=unknown%20error&from=paste&height=292&id=B64WP&originHeight=292&originWidth=391&originalType=binary&ratio=1&rotation=0&showTitle=false&size=9757&status=error&style=none&taskId=u4a5778ac-dbe6-4f97-8134-67e3c5678f3&title=&width=391",alt:"image.png"}),"\n",(0,a.jsx)(e.code,{children:"BeanFactoryPostProcessor"}),":\u4e00\u822c\u7528\u4e8e\u4fee\u6539\u5df2\u7ecf\u6dfb\u52a0\u8fc7\u7684BeanName\u7684BeanDefinition\n",(0,a.jsx)(e.code,{children:"BeanDefinitionRegistryPostProcessor"}),"\uff1a\u4e00\u822c\u7528\u4e8e\u6dfb\u52a0BeanDefinition"]}),"\n",(0,a.jsxs)(e.p,{children:[(0,a.jsx)(e.code,{children:"**ImportBeanDefinitionRegistrar**"}),"\u901a\u8fc7",(0,a.jsx)(e.code,{children:"@Import"}),"\u6ce8\u89e3\u5b8c\u6210\u6ce8\u5165\uff0c",(0,a.jsx)(e.code,{children:"@Import"}),"\u653e\u5728",(0,a.jsx)(e.code,{children:"@Configuration"}),"\u4e0a\n",(0,a.jsx)(e.strong,{children:"ImportBeanDefinitionRegistrar"}),"\uff1a\u5b83\u53ef\u4ee5\u5f80\u5bb9\u5668\u4e2d\u6ce8\u5165 BeanDefinition \u5e76\u4e14\u8fd8\u53ef\u4ee5\u6ce8\u5165BeanFactoryPostProcessor BeanDefinitionRegistryPostProcessor\uff0c\u56e0\u4e3a\u5b83\u6bd4\u4ed6\u4eec\u4e24\u4e2a\u5148\u6267\u884c"]}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-java",children:"public interface ImportBeanDefinitionRegistrar {\n    //importingClassMetadata \u53ef\u4ee5\u83b7\u53d6\u5230\u4f7f\u7528@Import(importBeanDefinitionRegistar.class) \u4f5c\u7528\u7684\u7c7b\u4e0a\u4fe1\u606f\n    public void registerBeanDefinitions(AnnotationMetadata importingClassMetadata, BeanDefinitionRegistry registry, BeanNameGenerator importBeanNameGenerator) {\n    }\n}\n"})}),"\n",(0,a.jsxs)(e.p,{children:[(0,a.jsx)(e.strong,{children:"ImportSelector"}),"\uff1aspirngboot\u7684\u81ea\u52a8\u914d\u7f6e\u4e5f\u662f\u901a\u8fc7\u8be5\u63a5\u53e3\u5b9e\u73b0\uff0c\u5b83\u53ef\u4ee5\u6dfb\u52a0\u6307\u5b9a\u8fd4\u56de\u4e00\u4e2a\u6570\u7ec4\uff0c\u6570\u7ec4\u91cc\u9762\u90fd\u662f\u8981\u52a0\u5165\u5230Ioc\u5bb9\u5668\u7684\u7c7b\uff0c\u901a\u8fc7",(0,a.jsx)(e.code,{children:"@Import"}),"\u6ce8\u89e3\u5b8c\u6210\u6ce8\u5165"]}),"\n",(0,a.jsx)(e.p,{children:(0,a.jsx)(e.img,{src:"https://cdn.nlark.com/yuque/0/2023/svg/1741454/1682408776531-03df4a8a-c9f1-4e6e-8d50-8a181d12759e.svg#clientId=uca6c9f1a-e641-4&from=paste&height=1864&id=ua4684ae5&originHeight=1864&originWidth=2390&originalType=binary&ratio=1&rotation=0&showTitle=false&size=39332&status=done&style=none&taskId=u5062a7ec-5c3e-4de9-8e4f-3ac909aaa90&title=&width=2390",alt:"spring ioc.svg"})}),"\n",(0,a.jsxs)(e.p,{children:[(0,a.jsx)(e.strong,{children:"AbstractApplicationContext"}),"\u7684refresh\u65b9\u6cd5\u4e2d\u7684invokeBeanFactoryPostProcessors\u65b9\u6cd5\u8fdb\u884cBeanFactoryProcessor\u7684\u8c03\u7528\uff0c\u5b8c\u6210BeanFactoryProcess\u89e3\u6790\u4ee5\u53ca\u8c03\u7528"]}),"\n",(0,a.jsx)(e.p,{children:"\uff08BeanDefinitionRegistryPostProcessor\u83b7\u53d6->\u6267\u884cpostProcessBeanDefinitionRegistry\uff09\uff08\u7b2c\u4e00\u6b21\u6267\u884c\u8fd9\u4e2a\u662f\u6267\u884c\u65b9\u6cd5\u53c2\u6570\u4f20\u5165\u7684BeanDefinitionRegistryPostProcessor\uff09->\uff08BeanDefinitionRegistryPostProcessor\u83b7\u53d6->\u6267\u884cpostProcessBeanDefinitionRegistry\uff09\uff08\u7b2c\u4e8c\u6b21\u6267\u884c\u662f\u6267\u884cBeanFactory.getBeanNamesForType(BeanDefinitionRegistryPostProcessor.class)\u83b7\u53d6\u5230\u7684\u5e76\u5e26\u6709Order\u63a5\u53e3\u7684\uff09->\uff08\u5faa\u73af\u904d\u5386\u83b7\u53d6BeanDefinitionRegistryPostProcessor->\u6267\u884cpostProcessBeanDefinitionRegistry\uff09->\u5728\u6267\u884c\u6240\u6709BeanDefinitionRegistryPostProcessor\u7684postProcessBeanFactory\u65b9\u6cd5-\u300b\uff08\u83b7\u53d6\u6240\u6709\u6709PriorityOrdered\u987a\u5e8f\u7684BeanFactoryPostProcessor\uff0c\u5982\u679cbeanName\u5df2\u7ecf\u5728\u5904\u7406\u8fc7\u7684set\u96c6\u5408\u4e2d\u4e86\u5c31\u8df3\u8fc7->\u6267\u884cpostProcessBeanFactory\uff09-\u300b\uff08\u83b7\u53d6\u6240\u6709\u6709Ordered\u987a\u5e8f\u7684BeanFactoryPostProcessor\uff0c\u5982\u679cbeanName\u5df2\u7ecf\u5728\u5904\u7406\u8fc7\u7684set\u96c6\u5408\u4e2d\u4e86\u5c31\u8df3\u8fc7->\u6267\u884cpostProcessBeanFactory\uff09-\u300b\uff08\u83b7\u53d6\u6240\u6709\u6709\u6ca1\u6709\u987a\u5e8f\u7684BeanFactoryPostProcessor\uff0c\u5982\u679cbeanName\u5df2\u7ecf\u5728\u5904\u7406\u8fc7\u7684set\u96c6\u5408\u4e2d\u4e86\u5c31\u8df3\u8fc7->\u6267\u884cpostProcessBeanFactory\uff09\n\u6ce8\u610f\uff1aBeanDefinitionRegistryPostProcessor#postProcessBeanDefinitionRegistry\u6bcf\u6b21\u6267\u884c\u5b8c\u8fd9\u4e2a\u90fd\u4f1a\u52a0\u5165\u5230set\u96c6\u5408\u4e2d\uff0c\u4e0b\u6b21\u5728\u83b7\u53d6bean\u7684\u65f6\u5019\u4f1a\u6392\u9664\u4ed6\u4eec\u7684\u6267\u884c\n\u5728BeanDefinitionRegistryPostProcessor\u4e2d\u8fd8\u53ef\u4ee5\u6ce8\u5165BeanFactoryPostProcessor\u7684BeanDefinition\uff0c\u4f46\u662fBeanFactoryPostProcessor\u4e0d\u80fd\u6ce8\u5165BeanDefinitionRegistryPostProcessor"}),"\n",(0,a.jsx)(e.h1,{id:"bean\u7684\u751f\u547d\u5468\u671f",children:"Bean\u7684\u751f\u547d\u5468\u671f"}),"\n",(0,a.jsxs)(e.p,{children:["\u5728spring\u4e2d\u4e00\u4e2a\u5bf9\u8c61\u7684\u751f\u547d\u5468\u671f\u4e3a\n",(0,a.jsx)(e.img,{src:"https://cdn.nlark.com/yuque/0/2022/jpeg/1741454/1662513206706-14ced250-cb42-4988-acdb-27eb0f95d910.jpeg",alt:""}),"\nspring\u5728\u5b9e\u4f8b\u5316\u524d\u540e\uff0c\u4ee5\u53ca\u521d\u59cb\u5316\u524d\u540e\u90fd\u505a\u4e86\u5bf9\u5e94\u7684\u6269\u5c55\n",(0,a.jsx)(e.strong,{children:"Bean\u7684\u540e\u7f6e\u5904\u7406\u5668\u662f\u6240\u6709bean\u5728\u521b\u5efa\u7684\u65f6\u5019\u90fd\u4f1a\u7ecf\u5386\u7684"}),"\n",(0,a.jsx)(e.strong,{children:"Bean\u7684\u521d\u59cb\u5316\u662fbean\u81ea\u5df1\u7684\u521d\u59cb\u5316"})]}),"\n",(0,a.jsx)(e.h2,{id:"bean\u7684\u540e\u7f6e\u5904\u7406\u5668",children:"Bean\u7684\u540e\u7f6e\u5904\u7406\u5668"}),"\n",(0,a.jsxs)(e.p,{children:[(0,a.jsx)(e.img,{src:"https://cdn.nlark.com/yuque/0/2022/png/1741454/1662510889968-d40796ba-40fe-4b7e-9103-48e38315e3db.png#averageHue=%23f8f7f7&clientId=u1e2e0e45-e01d-4&errorMessage=unknown%20error&from=paste&height=280&id=ucba36e3a&originHeight=280&originWidth=829&originalType=binary&ratio=1&rotation=0&showTitle=false&size=10490&status=error&style=none&taskId=udb7c71e2-2abc-47af-b4de-c653cb218c2&title=&width=829",alt:"image.png"}),"\n\u4e3b\u8981\u6709\n",(0,a.jsx)(e.code,{children:"InstantiationAwareBeanPostProcessor"}),"\uff1a\u5b9e\u4f8b\u5316\u524d\u540e\uff0c\u8fd8\u6709\u5c5e\u6027\u586b\u5145\n",(0,a.jsx)(e.code,{children:"BeanPostProcessor"}),"\uff1a\u521d\u59cb\u5316\u524d\u540e\n",(0,a.jsx)(e.code,{children:"DestructionAwareBeanPostProcessor"}),"\uff1abean\u9500\u6bc1\u7684\u65f6\u5019\u8c03\u7528\n",(0,a.jsx)(e.code,{children:"SmartInstantiationAwareBeanPostProcessor"}),"\uff1a",(0,a.jsx)(e.code,{children:"getEarlyBeanReference"}),"\u65b9\u6cd5\u7528\u4e8e\u89e3\u51b3\u5faa\u73af\u4f9d\u8d56\u95ee\u9898"]}),"\n",(0,a.jsxs)(e.p,{children:[(0,a.jsx)(e.img,{src:"https://cdn.nlark.com/yuque/0/2022/png/1741454/1662694197706-aa2b45c3-4005-4662-860f-accead41e841.png#averageHue=%23eac581&clientId=u533c6d0a-db05-4&errorMessage=unknown%20error&from=paste&height=315&id=uc1b5d608&originHeight=315&originWidth=1899&originalType=binary&ratio=1&rotation=0&showTitle=false&size=106539&status=error&style=none&taskId=uc96af09d-a94b-4805-b362-c1734b50c90&title=&width=1899",alt:"image.png"}),"\n\u521d\u59cb\u5316\u903b\u8f91\uff1a\n",(0,a.jsx)(e.img,{src:"https://cdn.nlark.com/yuque/0/2022/png/1741454/1662475670827-4b351544-6b30-423d-9b9d-206e43373427.png#averageHue=%232d2c2c&clientId=u8b83da76-d04d-4&errorMessage=unknown%20error&from=paste&height=760&id=rMAH6&originHeight=1520&originWidth=1988&originalType=binary&ratio=1&rotation=0&showTitle=false&size=241594&status=error&style=none&taskId=u9d64b593-317f-4360-b3e5-9b0c0e6dca6&title=&width=994",alt:"image.png"}),"\n\u901a\u8fc7\u4ee3\u7801\u5b9e\u73b0\u521d\u59cb\u5316 \uff0c\u5b9e\u4f8b\u5316\uff0c\u7684\u52a0\u8f7d\u6269\u5c55\u70b9\u67e5\u770b\u52a0\u8f7d\u65f6\u673a"]}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-java",children:'@Component("lifeCycleBean")\npublic class LifeCycleBean {\n    private static final Logger log= LoggerFactory.getLogger(LifeCycleBean.class);\n\n    public LifeCycleBean() {\n        log.info("\u6784\u9020\u3002\u3002");\n    }\n\n    @Autowired\n    public void autoWire(@Value("${java.home}") String home){\n        log.info("\u4f9d\u8d56\u6ce8\u5165\uff1a{}",home);\n    }\n\n    @PostConstruct\n    public void init(){\n        log.info("\u521d\u59cb\u5316\uff1a@PostConstruct");\n    }\n\n    @PreDestroy\n    public void preDestroy(){\n        log.info("\u9500\u6bc1\u3002\u3002\u3002");\n    }\n}\n\n'})}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-java",children:'/**\n * \u5b9e\u4f8b\u5316\u4e4b\u524d-\u300b\u6784\u9020-\u300b\u5b9e\u4f8b\u5316\u540e-\u300b\u5c5e\u6027\u6ce8\u5165-\u300b\u521d\u59cb\u5316\u524d-\u300b\u521d\u59cb\u5316\u540e\n * @author \u5357\u987e\u5317\u886b\n * @description\n * @date 2022/9/6\n */\n@Component\npublic class MyPostProcessor implements InstantiationAwareBeanPostProcessor, DestructionAwareBeanPostProcessor {\n    private static final Logger log = LoggerFactory.getLogger(MyPostProcessor.class);\n\n    //=============DestructionAwareBeanPostProcessor\n    @Override\n    public void postProcessBeforeDestruction(Object bean, String beanName) throws BeansException {\n        if (beanName.equals("lifeCycleBean")) {\n            log.info("<<<<<<\u9500\u6bc1\u65b9\u6cd5\u4e4b\u524d\u6267\u884c \uff0c\u5982@PreDestory");\n        }\n    }\n\n    @Override\n    public boolean requiresDestruction(Object bean) {\n        return true;\n    }\n\n    //============BeanPostProcessor\n    /**\n     * \u521d\u59cb\u5316\uff1a\n        aware(beanNameAware,BeanClassLoadAware,BeanFactoryAware)->postProcessBeforeInitialization->InitializingBean->xml\u4e2d\u81ea\u5b9a\u4e49\u7684init-method\u65b9\u6cd5->postProcessAfterInitialization\n     */\n\n    @Override\n    public Object postProcessBeforeInitialization(Object bean, String beanName) throws BeansException {\n        if (beanName.equals("lifeCycleBean")) {\n            log.info("<<<<<<\u521d\u59cb\u5316\u4e4b\u524d\u6267\u884c\uff0c\u5982@PostConstruct @ConfigurationProperties ");\n        }\n        return bean;\n    }\n\n    @Override\n    public Object postProcessAfterInitialization(Object bean, String beanName) throws BeansException {\n        if (beanName.equals("lifeCycleBean")) {\n            log.info("<<<<<<\u521d\u59cb\u5316\u4e4b\u540e\u6267\u884c ,\u8fd4\u56de\u5bf9\u8c61\u4f1a\u66ff\u6362\u539f\u6765\u7684bean \u5982\u4ee3\u7406\u589e\u5f3a");\n        }\n        return bean;\n    }\n\n    //====InstantiationAwareBeanPostProcessor\n    @Override\n    public Object postProcessBeforeInstantiation(Class<?> beanClass, String beanName) throws BeansException {\n        if (beanName.equals("lifeCycleBean")) {\n            log.info("<<<<<<\u5b9e\u4f8b\u5316\u4e4b\u524d\u6267\u884c ");\n        }\n        return null;\n    }\n\n    @Override\n    public boolean postProcessAfterInstantiation(Object bean, String beanName) throws BeansException {\n        if (beanName.equals("lifeCycleBean")) {\n            log.info("<<<<<<\u5b9e\u4f8b\u5316\u4e4b\u540e\u6267\u884c \uff0c\u8fd4\u56defalse\u4f1a\u8df3\u8fc7\u4f9d\u8d56\u6ce8\u5165\u9636\u6bb5");\n        }\n        return true;\n    }\n\n    @Override\n    public PropertyValues postProcessProperties(PropertyValues pvs, Object bean, String beanName) throws BeansException {\n        if (beanName.equals("lifeCycleBean")) {\n            log.info("<<<<<<\u4f9d\u8d56\u6ce8\u5165\u9636\u6bb5 @AutoWried  @Resource @Value");\n        }\n        return pvs;\n    }\n}\n\n'})}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-java",children:"@SpringBootApplication\npublic class LifeBeanApplication {\n    public static void main(String[] args) {\n        ConfigurableApplicationContext run = SpringApplication.run(LifeBeanApplication.class, args);\n        run.close();\n    }\n}\n\n"})}),"\n",(0,a.jsx)(e.p,{children:(0,a.jsx)(e.img,{src:"https://cdn.nlark.com/yuque/0/2022/png/1741454/1662606028652-abf6dbe1-542a-48ae-bc0c-323a06ad1643.png#averageHue=%23f8f6f4&clientId=uca4ba74a-27e1-4&errorMessage=unknown%20error&from=paste&height=608&id=u349b5dd6&originHeight=608&originWidth=1765&originalType=binary&ratio=1&rotation=0&showTitle=false&size=253150&status=error&style=none&taskId=uf1f25d84-a690-44db-9045-2013f7a0dd0&title=&width=1765",alt:"image.png"})}),"\n",(0,a.jsx)(e.h2,{id:"\u5e38\u7528\u7684bean\u540e\u7f6e\u5904\u7406\u5668",children:"\u5e38\u7528\u7684Bean\u540e\u7f6e\u5904\u7406\u5668"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-java",children:"AutowiredAnnotationBeanPostProcessor \u5904\u7406@Autowired @Value\u6ce8\u5165\u6ce8\u89e3\n    \nCommonAnnotationBeanPostProcessor  \u5904\u7406@Resource @PostConstruct @PreDestroy\n    \nConfigurationPropertiesBindingPostProcessor \u5904\u7406@ConfigurationProperties\n"})}),"\n",(0,a.jsx)(e.h3,{id:"autowiredannotationbeanpostprocessor",children:"AutowiredAnnotationBeanPostProcessor"}),"\n",(0,a.jsxs)(e.p,{children:[(0,a.jsx)(e.code,{children:"@Autowired"}),"\u6ce8\u89e3\u89e3\u6790\u7528\u5230\u7684\u540e\u5904\u7406\u5668\u662f",(0,a.jsx)(e.code,{children:"AutowiredAnnotationBeanPostProcessor"})]}),"\n",(0,a.jsxs)(e.ul,{children:["\n",(0,a.jsxs)(e.li,{children:["\u8fd9\u4e2a\u540e\u5904\u7406\u5668\u5c31\u662f\u901a\u8fc7\u8c03\u7528",(0,a.jsx)(e.code,{children:"postProcessProperties(PropertyValues pvs, Object bean, String beanName)"}),"\u5b8c\u6210\u6ce8\u89e3\u7684\u89e3\u6790\u548c\u6ce8\u5165\u7684\u529f\u80fd"]}),"\n",(0,a.jsxs)(e.li,{children:["\u8fd9\u4e2a\u65b9\u6cd5\u4e2d\u53c8\u8c03\u7528\u4e86\u4e00\u4e2a\u79c1\u6709\u7684\u65b9\u6cd5",(0,a.jsx)(e.code,{children:"findAutowiringMetadata(beanName, bean.getClass(), pvs)"}),"\uff0c\u5176\u8fd4\u56de\u503c",(0,a.jsx)(e.code,{children:"InjectionMetadata"}),"\u4e2d\u5c01\u88c5\u4e86\u88ab",(0,a.jsx)(e.code,{children:"@Autowired"}),"\u6ce8\u89e3\u4fee\u9970\u7684\u5c5e\u6027\u548c\u65b9\u6cd5"]}),"\n",(0,a.jsxs)(e.li,{children:["\u7136\u540e\u4f1a\u8c03\u7528",(0,a.jsx)(e.code,{children:'InjectionMetadata.inject(bean1, "bean1", null)'}),"\u8fdb\u884c\u4f9d\u8d56\u6ce8\u5165"]}),"\n",(0,a.jsxs)(e.li,{children:["\u7531\u4e8e",(0,a.jsx)(e.code,{children:'InjectionMetadata.inject(bean1, "bean1", null)'}),"\u7684\u6e90\u7801\u8c03\u7528\u94fe\u8fc7\u957f\uff0c\u6458\u51fa\u4e3b\u8981\u8c03\u7528\u8fc7\u7a0b\u8fdb\u884c\u8bf4\u660e\uff1a"]}),"\n",(0,a.jsxs)(e.li,{children:["\u6210\u5458\u53d8\u91cf\u6ce8\u5165\uff0c",(0,a.jsx)(e.code,{children:"InjectionMetadata"}),"\u6ce8\u5165",(0,a.jsx)(e.code,{children:"Bean3"}),"\u7684\u8fc7\u7a0b\uff1a","\n",(0,a.jsxs)(e.ul,{children:["\n",(0,a.jsxs)(e.li,{children:[(0,a.jsx)(e.code,{children:"InjectionMetadata"}),"\u4f1a\u628a",(0,a.jsx)(e.code,{children:"Bean1"}),"\u4e2d\u52a0\u4e86",(0,a.jsx)(e.code,{children:"@Autowired"}),"\u6ce8\u89e3\u7684\u5c5e\u6027\u7684",(0,a.jsx)(e.code,{children:"BeanName"}),"\u5148\u62ff\u5230\uff0c\u8fd9\u91cc\u62ff\u5230\u7684",(0,a.jsx)(e.code,{children:"BeanName"}),"\u5c31\u662f ",(0,a.jsx)(e.code,{children:"bean3"}),"\uff0c\u7136\u540e\u518d\u901a\u8fc7\u53cd\u5c04\u62ff\u5230\u8fd9\u4e2a\u5c5e\u6027\uff0c",(0,a.jsx)(e.code,{children:'Field bean3Field = Bean1.class.getDeclaredField("bean3");'})]}),"\n",(0,a.jsxs)(e.li,{children:["\u5c06\u8fd9\u4e2a\u5c5e\u6027\u5c01\u88c5\u6210\u4e00\u4e2a",(0,a.jsx)(e.code,{children:"DependencyDescriptor"}),"\u5bf9\u8c61\uff0c\u518d\u53bb\u8c03\u7528",(0,a.jsx)(e.code,{children:"Bean3 bean3Value = (Bean3) beanFactory.doResolveDependency(dd1, null, null, null);"}),"\u62ff\u5230",(0,a.jsx)(e.code,{children:"bean3Value"})]}),"\n",(0,a.jsxs)(e.li,{children:["\u6700\u540e\u628a\u503c\u8d4b\u7ed9\u8fd9\u4e2a\u5c5e\u6027",(0,a.jsx)(e.code,{children:"bean3Field.set(bean1, bean3Value);"})]}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(e.li,{children:["\u65b9\u6cd5\u53c2\u6570\u6ce8\u5165\uff0c",(0,a.jsx)(e.code,{children:"InjectionMetadata"}),"\u6ce8\u5165",(0,a.jsx)(e.code,{children:"Bean2"}),"\u7684\u8fc7\u7a0b\uff1a","\n",(0,a.jsxs)(e.ul,{children:["\n",(0,a.jsxs)(e.li,{children:[(0,a.jsx)(e.code,{children:"InjectionMetadata"}),"\u4f1a\u628a",(0,a.jsx)(e.code,{children:"Bean1"}),"\u4e2d\u52a0\u4e86",(0,a.jsx)(e.code,{children:"@Autowired"}),"\u6ce8\u89e3\u7684\u65b9\u6cd5\u7684",(0,a.jsx)(e.code,{children:"MethodName"}),"\u5148\u62ff\u5230\uff0c\u8fd9\u91cc\u62ff\u5230\u7684",(0,a.jsx)(e.code,{children:"MethodName"}),"\u5c31\u662f ",(0,a.jsx)(e.code,{children:"setBean2"}),"\uff0c\u7136\u540e\u518d\u901a\u8fc7\u53cd\u5c04\u62ff\u5230\u8fd9\u4e2a\u65b9\u6cd5\uff0c",(0,a.jsx)(e.code,{children:'Method setBean2 = Bean1.class.getDeclaredMethod("setBean2", Bean2.class);'})]}),"\n",(0,a.jsxs)(e.li,{children:["\u5c06\u8fd9\u4e2a\u5c5e\u6027\u5c01\u88c5\u6210\u4e00\u4e2a",(0,a.jsx)(e.code,{children:"DependencyDescriptor"}),"\u5bf9\u8c61\uff0c\u518d\u53bb\u8c03\u7528",(0,a.jsx)(e.code,{children:'Bean2 bean2Value = (Bean2) beanFactory.doResolveDependency(dd2, "bean2", null, null);'}),"\u62ff\u5230",(0,a.jsx)(e.code,{children:"bean2Value"})]}),"\n",(0,a.jsxs)(e.li,{children:["\u6700\u540e\u8c03\u7528\u65b9\u6cd5",(0,a.jsx)(e.code,{children:"setBean2.invoke(bean1, bean2Value)"}),"\uff0c\u7ed9\u65b9\u6cd5\u53c2\u6570\u8d4b\u503c\u3002"]}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(e.li,{children:["\u65b9\u6cd5\u53c2\u6570\u6ce8\u5165\uff0c\u53c2\u6570\u7c7b\u578b\u4e3aString\u7c7b\u578b\uff0c\u4e14\u52a0\u4e0a\u4e86@Value\u6ce8\u89e3\uff0c",(0,a.jsx)(e.code,{children:"InjectionMetadata"}),"\u6ce8\u5165\u73af\u5883\u53d8\u91cf",(0,a.jsx)(e.code,{children:"JAVA_HOME"}),"\u7684\u8fc7\u7a0b\uff1a","\n",(0,a.jsxs)(e.ul,{children:["\n",(0,a.jsxs)(e.li,{children:[(0,a.jsx)(e.code,{children:"InjectionMetadata"}),"\u4f1a\u628a",(0,a.jsx)(e.code,{children:"Bean1"}),"\u4e2d\u52a0\u4e86",(0,a.jsx)(e.code,{children:"@Autowired"}),"\u6ce8\u89e3\u7684\u65b9\u6cd5\u7684",(0,a.jsx)(e.code,{children:"MethodName"}),"\u5148\u62ff\u5230\uff0c\u8fd9\u91cc\u62ff\u5230\u7684",(0,a.jsx)(e.code,{children:"MethodName"}),"\u5c31\u662f ",(0,a.jsx)(e.code,{children:"setJava_home"}),"\uff0c\u7136\u540e\u518d\u901a\u8fc7\u53cd\u5c04\u62ff\u5230\u8fd9\u4e2a\u65b9\u6cd5\uff0c",(0,a.jsx)(e.code,{children:'Method setJava_home = Bean1.class.getDeclaredMethod("setJava_home", String.class);'})]}),"\n",(0,a.jsxs)(e.li,{children:["\u5c06\u8fd9\u4e2a\u5c5e\u6027\u5c01\u88c5\u6210\u4e00\u4e2a",(0,a.jsx)(e.code,{children:"DependencyDescriptor"}),"\u5bf9\u8c61\uff0c\u518d\u53bb\u8c03\u7528",(0,a.jsx)(e.code,{children:"String java_home = (String) beanFactory.doResolveDependency(dd3, null, null, null);"}),"\u62ff\u5230",(0,a.jsx)(e.code,{children:"java_home"})]}),"\n",(0,a.jsxs)(e.li,{children:["\u6700\u540e\u8c03\u7528\u65b9\u6cd5",(0,a.jsx)(e.code,{children:"setJava_home.invoke(bean1, java_home);"}),"\uff0c\u7ed9\u65b9\u6cd5\u53c2\u6570\u8d4b\u503c\u3002"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(e.p,{children:["\u901a\u8fc7",(0,a.jsx)(e.code,{children:"InstantiationAwareBeanPostProcessor#postProcessProperties"}),"\u4f9d\u8d56\u6ce8\u5165\u9636\u6bb5\u7684\u6269\u5c55\u70b9"]}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-java",children:'\tpublic PropertyValues postProcessProperties(PropertyValues pvs, Object bean, String beanName) {\n\t\tInjectionMetadata metadata = findAutowiringMetadata(beanName, bean.getClass(), pvs);\n\t\ttry {\n\t\t\tmetadata.inject(bean, beanName, pvs);\n\t\t}\n\t\tcatch (BeanCreationException ex) {\n\t\t\tthrow ex;\n\t\t}\n\t\tcatch (Throwable ex) {\n\t\t\tthrow new BeanCreationException(beanName, "Injection of autowired dependencies failed", ex);\n\t\t}\n\t\treturn pvs;\n\t}\n'})}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-java",children:'    public static void main(String[] args) throws Throwable {\n        DefaultListableBeanFactory beanFactory = new DefaultListableBeanFactory();\n\n//        beanFactory.registerSingleton("bean1", new Bean1());\n        beanFactory.registerSingleton("bean2", new Bean2());\n\n        beanFactory.setAutowireCandidateResolver(new ContextAnnotationAutowireCandidateResolver());\n        beanFactory.addEmbeddedValueResolver(new StandardEnvironment()::resolvePlaceholders);\n\n        AutowiredAnnotationBeanPostProcessor autowiredAnnotationBeanPostProcessor = new AutowiredAnnotationBeanPostProcessor();\n        autowiredAnnotationBeanPostProcessor.setBeanFactory(beanFactory);\n\n        Bean1 bean1 = new Bean1();\n        //========\u4f7f\u7528autowiredAnnotationBeanPostProcessor\u63d0\u4f9b\u7684postProcessProperties\u8fdb\u884c\u5c5e\u6027\u586b\u5145\n//        autowiredAnnotationBeanPostProcessor.postProcessProperties(null, bean1, "bean1");\n//\n//        System.out.println(bean1);\n\n\n        //=================\u901a\u8fc7AutowiredAnnotationBeanPostProcessor\u7684\u5185\u90e8\u65b9\u6cd5\u8fdb\u884c\u8c03\u7528\u586b\u5145,\u79bb\u6e90\u7801\u6709\u8fd1\u4e86\u4e00\u6b65\n        //1.\u901a\u8fc7\u8c03\u7528AutowiredAnnotationBeanPostProcessor.findAutowiringMetadata()\u627e\u5230\u8981\u6ce8\u5165\u7684\u5b57\u6bb5\u6216\u8005\u65b9\u6cd5\u53c2\u6570\n//        Method findAutowiringMetadata = AutowiredAnnotationBeanPostProcessor.class.getDeclaredMethod("findAutowiringMetadata", String.class, Class.class, PropertyValues.class);\n//        findAutowiringMetadata.setAccessible(true);\n//        InjectionMetadata injectionMetadata = (InjectionMetadata) findAutowiringMetadata.invoke(autowiredAnnotationBeanPostProcessor, "bean1", Bean1.class, null);\n//        System.out.println(injectionMetadata);\n//\n//        //2.\u6ce8\u5165\u4f9d\u8d56\n//        injectionMetadata.inject(bean1, null, null);\n//        System.out.println(bean1);\n\n\n        //==========\u76f4\u63a5\u4f7f\u7528\u5e95\u5c42\u6e90\u7801\u5b9e\u73b0\u6ce8\u5165\n        //1.\u65b9\u6cd5\u6ce8\u5165 \u83b7\u53d6@AutoWried\u6ce8\u89e3\u5bf9\u5e94\u7684\u65b9\u6cd5->\u5c01\u88c5\u6210MethodParameter -\u300b\u5c01\u88c5DependencyDescriptor-\u300bbeanFactory.doResolveDependency\u5f97\u5230\u4f9d\u8d56\u7ed3\u679c->\u53cd\u5c04\u8c03\u7528\u65b9\u6cd5  \u7ed9\u65b9\u6cd5\u53c2\u6570\u8d4b\u503c\n        Method setBean2 = bean1.getClass().getDeclaredMethod("setBean2", Bean2.class);\n        MethodParameter methodParameter = new MethodParameter(setBean2, 0);\n        DependencyDescriptor dependencyDescriptor = new DependencyDescriptor(methodParameter, false);\n        Bean2 bean2 = (Bean2) beanFactory.doResolveDependency(dependencyDescriptor, "bean2", null, null);\n        setBean2.invoke(bean1, bean2);\n        System.out.println(bean1);\n\n        //2. @value\u6ce8\u5165\n        Method setHome = bean1.getClass().getDeclaredMethod("setHome", String.class);\n        MethodParameter mtp1 = new MethodParameter(setHome, 0);\n        DependencyDescriptor dp1 = new DependencyDescriptor(mtp1, false);\n        String home = (String) beanFactory.doResolveDependency(dp1, null, null, null);\n        setHome.invoke(bean1, home);\n        System.out.println(bean1);\n    }\n'})}),"\n",(0,a.jsx)(e.h1,{id:"\u5e38\u89c1bean\u5de5\u5382\u540e\u5904\u7406\u5668\u4ee5\u53ca\u6a21\u62df\u5b9e\u73b0\u7ec4\u4ef6\u626b\u63cf",children:"\u5e38\u89c1Bean\u5de5\u5382\u540e\u5904\u7406\u5668\u4ee5\u53ca\u6a21\u62df\u5b9e\u73b0\u7ec4\u4ef6\u626b\u63cf"}),"\n",(0,a.jsx)(e.h2,{id:"configurationclasspostprocessor",children:(0,a.jsx)(e.code,{children:"ConfigurationClassPostProcessor"})}),"\n",(0,a.jsxs)(e.p,{children:[(0,a.jsx)(e.code,{children:"ConfigurationClassPostProcessor"}),"\u5904\u7406\u5668\u5668\u53ef\u4ee5\u5904\u7406",(0,a.jsx)(e.code,{children:"@Configration  @Import @ImportResource @Bean @ComponentScan @**PropertySources**"}),"\u8fd9\u4e9b\u6ce8\u89e3"]}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-java",children:'public class TestBeanFactoryPostProcessors {\n\n    public static void main(String[] args) {\n        //\u2b07\ufe0fGenericApplicationContext \u662f\u4e00\u4e2a\u3010\u5e72\u51c0\u3011\u7684\u5bb9\u5668\uff0c\u9ed8\u8ba4\u4e0d\u4f1a\u6dfb\u52a0\u4efb\u4f55\u540e\u5904\u7406\u5668\uff0c\u65b9\u4fbf\u505a\u6d4b\u8bd5\n        GenericApplicationContext genericApplicationContext = new GenericApplicationContext();\n\n        //\u6ce8\u5165\u914d\u7f6e\u7c7b\n        genericApplicationContext.registerBean("myConfig", MyConfigTest.class);\n\n        //\u6ce8\u5165 @Configration  @Import @ImportSources @Bean @ComponentScan \u6ce8\u89e3\u5904\u7406\u5668\n        genericApplicationContext.addBeanFactoryPostProcessor(new ConfigurationClassPostProcessor());\n\n        //\u521d\u59cb\u5316\u5bb9\u5668  \u6267\u884c  beanFactoryPostProcess\u63a5\u53e3 -> beanPostProcess\u63a5\u53e3 -> \u5b9e\u4f8b\u5316 \u975e\u61d2\u52a0\u8f7d \u5355\u4f8bbean\u5bf9\u8c61\n        genericApplicationContext.refresh();\n\n        //\u83b7\u53d6\u5bb9\u5668\u91cc\u9762\u6240\u6709\u7684BeanDefinition\n        String[] beanDefinitionNames = genericApplicationContext.getBeanDefinitionNames();\n        for (String beanDefinitionName : beanDefinitionNames) {\n            System.out.println(beanDefinitionName);\n        }\n\n        //\u9500\u6bc1\u5bb9\u5668\n        genericApplicationContext.close();\n\n    }\n\n    @Configuration\n    static class MyConfigTest {\n        @Bean\n        public Bean1 bean1() {\n            return new Bean1();\n        }\n\n    }\n}\n'})}),"\n",(0,a.jsx)(e.h3,{id:"componentscan\u7684\u5904\u7406",children:"@ComponentScan\u7684\u5904\u7406"}),"\n",(0,a.jsxs)(e.p,{children:["\u4f7f\u7528spring\u63d0\u4f9b\u7684\u7c7b\u81ea\u5df1\u5199\u4e00\u4e2aspring\u7684",(0,a.jsx)(e.code,{children:"@ComponentScan"}),"\u6ce8\u89e3\u5904\u7406\uff0c\u5b8c\u6210BeanDefinition\u7684\u52a0\u8f7d"]}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-java",children:'public class MyConfigBeanFactoryPostProcess implements BeanDefinitionRegistryPostProcessor {\n    private final static Logger log = LoggerFactory.getLogger(MyConfigBeanFactoryPostProcess.class);\n\n    @Override\n    public void postProcessBeanDefinitionRegistry(BeanDefinitionRegistry registry) throws BeansException {\n        ComponentScan componentScan = AnnotationUtils.findAnnotation(TestMyBeanFactoryPostProcessors.MyConfigTest.class, ComponentScan.class);\n        if (componentScan != null) {\n            String[] basePackages = componentScan.basePackages();\n            for (String basePackage : basePackages) {\n                log.info("basePackage:{}", basePackage);\n                // top.jacktgq.component -> classpath*:com/jacktgq/component/**/*.class\n                String path = "classpath*:" + basePackage.replace(\'.\', \'/\') + "/**/*.class";\n                log.info("path:{}", path);\n\n                try {\n\n                    //\u914d\u5408MetadataReader\u4f7f\u7528\u53ef\u4ee5\u6839\u636eresource\u83b7\u53d6\u5230\u7c7b\u5143\u4fe1\u606f\n                    CachingMetadataReaderFactory factory = new CachingMetadataReaderFactory();\n\n                    //beanName\u751f\u6210\u5668  \uff0c\u4e3b\u8981\u6839\u636e\n                    AnnotationBeanNameGenerator generator = new AnnotationBeanNameGenerator();\n\n                    //   \u83b7\u53d6Component \u7684 \u5168\u7c7b\u540d\n                    String name = Component.class.getName();\n                    //\u6839\u636e\u8def\u5f84\u83b7\u53d6\u6587\u4ef6\u8d44\u6e90\n                    Resource[] resources = new PathMatchingResourcePatternResolver().getResources(path);\n                    for (Resource resource : resources) {\n                        //\u4f20\u5165resource\u53ef\u4ee5\u83b7\u53d6\u7c7b\u5143\u4fe1\u606f\uff0c\u5305\u62ec\u7c7b\u4fe1\u606f\uff0c\u6ce8\u89e3\u4fe1\u606f\n                        MetadataReader metadataReader = factory.getMetadataReader(resource);\n                        //\u53ef\u4ee5\u83b7\u53d6\u5230\u7c7b\u4e0a\u9762\u7684\u6ce8\u89e3\u4fe1\u606f\n                        AnnotationMetadata annotationMetadata = metadataReader.getAnnotationMetadata();\n\n                        //hasAnnotation \u5224\u65ad\u662f\u5426\u6709name\u6ce8\u89e3     \u6709\u5c31\u8fd4\u56detrue\n                        //hasMetaAnnotation \u53ea\u8981\u6ce8\u89e3\u7684\u7236\u7c7b\u6709\u5c31\u53ef\u4ee5  @service\u6709 @Component\u6ce8\u89e3\u5c31\u8fd4\u56detrue\n                        if (annotationMetadata.hasAnnotation(name) || annotationMetadata.hasMetaAnnotation(name)) {\n                            //\u751f\u6210beanDefinition\n                            AbstractBeanDefinition beanDefinition = BeanDefinitionBuilder.genericBeanDefinition(metadataReader.getClassMetadata().getClassName()).getBeanDefinition();\n                            //\u751f\u6210BeanName\n                            String beanName = generator.generateBeanName(beanDefinition, registry);\n                            //\u6ce8\u518c\u4fe1\u606f\n                            registry.registerBeanDefinition(beanName, beanDefinition);\n                        }\n                    }\n                } catch (IOException e) {\n                    e.printStackTrace();\n                }\n            }\n\n        }\n\n    }\n\n    @Override\n    public void postProcessBeanFactory(ConfigurableListableBeanFactory beanFactory) throws BeansException {\n\n    }\n}\n\n'})}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-java",children:'public class TestMyBeanFactoryPostProcessors {\n\n    public static void main(String[] args) {\n        //\u2b07\ufe0fGenericApplicationContext \u662f\u4e00\u4e2a\u3010\u5e72\u51c0\u3011\u7684\u5bb9\u5668\uff0c\u9ed8\u8ba4\u4e0d\u4f1a\u6dfb\u52a0\u4efb\u4f55\u540e\u5904\u7406\u5668\uff0c\u65b9\u4fbf\u505a\u6d4b\u8bd5\n        GenericApplicationContext genericApplicationContext = new GenericApplicationContext();\n\n        //\u6ce8\u5165\u914d\u7f6e\u7c7b\n        genericApplicationContext.registerBean("myConfig", MyConfigTest.class);\n\n        //\u6ce8\u5165 \u81ea\u5df1\u6a21\u62df@ComponentScan\u6ce8\u89e3 \u5de5\u5382\u540e\u7f6e\u5904\u7406\u5668\n        genericApplicationContext.addBeanFactoryPostProcessor(new MyConfigBeanFactoryPostProcess());\n\n        //\u521d\u59cb\u5316\u5bb9\u5668  \u6267\u884c  beanFactoryPostProcess\u63a5\u53e3 -> beanPostProcess\u63a5\u53e3 -> \u5b9e\u4f8b\u5316 \u975e\u61d2\u52a0\u8f7d \u5355\u4f8bbean\u5bf9\u8c61\n        genericApplicationContext.refresh();\n\n        //\u83b7\u53d6\u5bb9\u5668\u91cc\u9762\u6240\u6709\u7684BeanDefinition\n        String[] beanDefinitionNames = genericApplicationContext.getBeanDefinitionNames();\n        for (String beanDefinitionName : beanDefinitionNames) {\n            System.out.println(beanDefinitionName);\n        }\n\n        //\u9500\u6bc1\u5bb9\u5668\n        genericApplicationContext.close();\n\n    }\n\n    @ComponentScan(basePackages = {"com.wl.spring.sacn"})\n    @Configuration\n    static class MyConfigTest {\n        @Bean\n        public BeanScan2 beanScan2() {\n            return new BeanScan2();\n        }\n\n    }\n}\n'})}),"\n",(0,a.jsx)(e.h1,{id:"autowired\u6ce8\u89e3\u5931\u6548\u5206\u6790",children:"@Autowired\u6ce8\u89e3\u5931\u6548\u5206\u6790"}),"\n",(0,a.jsxs)(e.p,{children:[(0,a.jsx)(e.strong,{children:"BeanFactoryPostProcessor\u9636\u6bb5\u9700\u8981\u5148\u5b9e\u4f8b\u5316\u5bf9\u8c61\uff0c\u7136\u540e\u624d\u80fd\u6267\u884c\u540e\u7f6e\u5904\u7406"}),(0,a.jsx)(e.code,{children:"**postProcessBeanFactory**"}),"\nApplicationContextAwareProcessor\u7684bean\u540e\u7f6e\u5904\u7406\u5668\u5728refresh\u7684prepareBeanFactory()\u65b9\u6cd5\u4e2d\u5c31\u6267\u884c\u4e86\u6dfb\u52a0\u540e\u7f6e\u5904\u7406\u5668"]}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-java",children:"@Component\npublic class MyBean1 {\n    private String name;\n\n    @Override\n    public String toString() {\n        return \"MyBean1{\" +\n                \"name='\" + name + '\\'' +\n                '}';\n    }\n\n    public String getName() {\n        return name;\n    }\n\n    public void setName(String name) {\n        this.name = name;\n    }\n}\n\n"})}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-java",children:'@Configuration("myAutowiredConfig")\npublic class MyAutowiredConfig implements ApplicationContextAware {\n    private static final Logger log = LoggerFactory.getLogger(MyAutowiredConfig.class);\n\n    @Autowired\n    private void setMyBean1(MyBean1 myBean1) {\n        log.info("MyAutowiredConfig:Autowired mybean1={}", myBean1);\n    }\n\n    @PostConstruct\n    public void init() {\n        log.info("MyAutowiredConfig:\u521d\u59cb\u5316\u3002\u3002\u3002");\n    }\n\n    public MyAutowiredConfig() {\n        log.info("MyAutowiredConfig:\u6784\u9020\u3002\u3002\u3002");\n    }\n\n    //@Autowired  @PostConstruct\u4e0d\u4f1a\u5931\u6548\n    //\u56e0\u4e3a\u5b83\u662f\u9759\u6001\u5de5\u5382\uff0c\u4e0d\u9700\u8981\u5148\u5b9e\u4f8b\u5316MyAutowiredConfig\u8fd9\u4e2a\u5bf9\u8c61\u5c31\u80fd\u591f\u901a\u8fc7beanFactoryPostProcessor\u521b\u5efa\u6211\u7684BeanFactoryPostProcessor\n    /*@Bean\n    public static BeanFactoryPostProcessor beanFactoryPostProcessor() {\n        return (configurableListableBeanFactory) -> {\n            log.info("MyAutowiredConfig:beanPostProcessor\u3002\u3002\u3002");\n        };\n    }*/\n\n    //@Autowired  @PostConstruct\u4f1a\u5931\u6548\n    //\u56e0\u4e3a\u5b83\u662f\u5b9e\u4f8b\u5de5\u5382\uff0c\u5fc5\u987b\u8981\u5148\u628a\u5b9e\u4f8b\u521b\u5efa\u51fa\u6765\uff0c\u624d\u80fd\u8c03\u7528beanFactoryPostProcessor()\u521b\u5efa\u6211\u7684BeanFactoryPostProcessor,\u800c\u8bb8\u591abeanPostProcess\u662f\u5728BeanFactoryPostProcessor\u8c03\u7528\u540e\u624d\u6dfb\u52a0\u5230BeanFacotry\u4e2d\u7684\uff0c\n    // \u56e0\u6b64\uff0c\u5b83\u5b9e\u4f8b\u5316\u7684\u65f6\u5019\u4e5f\u5c31\u662fbeanFactory.getBean()\u7684\u65f6\u5019\uff0c\u6267\u884cbeanPostProcessor\u7684\u65f6\u5019\uff0cgetBeanPostProcessor()\u8fd8\u6ca1\u6709@Autowried @PostConstruct \u5bf9\u5e94\u7684bean\u540e\u7f6e\u5904\u7406\u5668\n    // AutowiredAnnotationBeanPostProcessor\u548cCommonAnnotationBeanPostProcessor\u5728beanFactory\u7684beanPostProcessor\u5217\u8868\u4e2d(\u4f46\u662f\u4ed6\u4eec\u5df2\u7ecf\u52a0\u5165\u4e86beanDefinitions\u91cc\u9762\u4e86\uff0c\u4f1a\u5728refresh\u65b9\u6cd5\u4e2d\u7684registerBeanPostProcessors()\u8fdb\u884c\u5b9e\u4f8b\u5316\uff0c\u6240\u4ee5\u5bfc\u81f4@Autowried @PostConstruct \u4e0d\u751f\u6548\n\n    //ApplicationContextAwareProcessor\u7684bean\u540e\u7f6e\u5904\u7406\u5668\u5728refresh\u7684prepareBeanFactory()\u65b9\u6cd5\u4e2d\u5c31\u6267\u884c\u4e86\u6dfb\u52a0\u540e\u7f6e\u5904\u7406\u5668\uff0c\u4e5f\u5c31\u662f\u5728\u8c03\u7528beanFactoryProcessor\u7684\u6269\u5c55\u70b9\u4e4b\u524d\u5c31\u6dfb\u52a0\u8fdb\u53bb\u4e86\uff0c\u6240\u4ee5\u90fd\u4f1a\u751f\u6548\n    @Bean\n    public  BeanFactoryPostProcessor beanFactoryPostProcessor() {\n        return (configurableListableBeanFactory) -> {\n            log.info("MyAutowiredConfig:beanPostProcessor\u3002\u3002\u3002");\n        };\n    }\n\n\n    @Override\n    public void setApplicationContext(ApplicationContext applicationContext) throws BeansException {\n        log.info("MyAutowiredConfig:ApplicationContextAware\u3002\u3002\u3002");\n    }\n}\n\n'})}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-java",children:"@SpringBootApplication\npublic class AutowiredInvalidTest {\n    public static void main(String[] args) {\n        SpringApplication.run(AutowiredInvalidTest.class,args);\n    }\n}\n\n"})}),"\n",(0,a.jsx)(e.h1,{id:"scope\u5931\u6548",children:"scope\u5931\u6548"}),"\n",(0,a.jsx)(e.p,{children:"\u6bd4\u5982\u5728\u5355\u4f8b\u4e2d,\u5982\u679c\u91cc\u9762\u9700\u8981\u4f7f\u7528@autowried\u6ce8\u5165\u4e00\u4e2a\u539f\u578b\u591a\u4f8b\u7684\u5bf9\u8c61,\u8fd9\u4e2a\u65f6\u5019\u591a\u6b21\u83b7\u53d6\u5230\u7684\u6ce8\u5165\u7684\u591a\u4f8b\u5bf9\u8c61\u5176\u5b9e\u90fd\u662f\u540c\u4e00\u4e2a"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-java",children:'@Scope(scopeName = "singleton")\npublic class MyScopeBean2 {\n    private String age;\n\n    private MyScopeBean1 myScopeBean1;\n\n    public String getAge() {\n        return age;\n    }\n\n    public void setAge(String age) {\n        this.age = age;\n    }\n\n    public MyScopeBean1 getMyScopeBean1() {\n        return myScopeBean1;\n    }\n\n//    @Lazy\n    @Autowired\n    public void setMyScopeBean1(MyScopeBean1 myScopeBean1) {\n        this.myScopeBean1 = myScopeBean1;\n    }\n}\n'})}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-java",children:'@Component\n//@Scope(scopeName = "prototype",proxyMode = ScopedProxyMode.TARGET_CLASS )\n@Scope(scopeName = "prototype")\npublic class MyScopeBean1 {\n    private String name;\n\n    public String getName() {\n        return name;\n    }\n\n    public void setName(String name) {\n        this.name = name;\n    }\n}\n\n'})}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-java",children:"@SpringBootApplication\npublic class ScopeApplication {\n    public static void main(String[] args) {\n        ConfigurableApplicationContext run = SpringApplication.run(ScopeApplication.class, args);\n\n        MyScopeBean2 myScopeBean2 = run.getBean(MyScopeBean2.class);\n        System.out.println(myScopeBean2.getMyScopeBean1());//1\n\n        MyScopeBean2 myScopeBean2 = run.getBean(MyScopeBean2.class);\n        System.out.println(myScopeBean2.getMyScopeBean1());  //2\n        //1\u548c2 \u6253\u5370\u51fa\u6765\u7684\u5bf9\u8c61\u5730\u5740\u90fd\u662f\u540c\u4e00\u4e2a\n    }\n"})}),"\n",(0,a.jsx)(e.p,{children:"\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u7684\u539f\u7406\u5c31\u662f\u5ef6\u8fdf\u83b7\u53d6bean\u5bf9\u8c61"}),"\n",(0,a.jsxs)(e.ol,{children:["\n",(0,a.jsx)(e.li,{children:"\u4f7f\u7528@Lazy"}),"\n",(0,a.jsx)(e.li,{children:"\u4f7f\u7528@Scope\u7684 \u901a\u8fc7@Scope\u7684\u4ee3\u7406\u6a21\u5f0f proxyMode=ScopedProxyMode.TARGET_CLASS \u4ea7\u751f\u4ee3\u7406\u7c7b"}),"\n",(0,a.jsx)(e.li,{children:"\u4f7f\u7528objectFactory"}),"\n",(0,a.jsx)(e.li,{children:"applicationContext\u83b7\u53d6"}),"\n"]})]})}function p(n={}){const{wrapper:e}={...(0,o.a)(),...n.components};return e?(0,a.jsx)(e,{...n,children:(0,a.jsx)(d,{...n})}):d(n)}},1151:(n,e,t)=>{t.d(e,{Z:()=>s,a:()=>r});var a=t(7294);const o={},i=a.createContext(o);function r(n){const e=a.useContext(i);return a.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function s(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(o):n.components||o:r(n.components),a.createElement(i.Provider,{value:e},n.children)}}}]);